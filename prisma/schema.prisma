generator client {
  provider   = "prisma-client-js"
  engineType = "binary"
}

datasource db {
  provider = "mongodb"
  url      = env("database_url")
}

model AcarsUser {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  name          String

  oauthAccounts OAuthAccount[]
  apiToken      String?
  isSuspended   Boolean   @default(false)

  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
}

model OAuthAccount {
  id            String    @id @default(auto()) @map("_id") @db.ObjectId
  provider      String    // "vatsim", "discord"
  providerId    String
  acarsUser     String    @db.ObjectId // Foreign key for AcarsUser
  
  accessToken   String
  refreshToken  String
  tokenExpiry   DateTime

  meta          Json?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  user          AcarsUser @relation(fields: [acarsUser], references: [id])
}